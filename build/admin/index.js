(()=>{"use strict";var e={n:t=>{var s=t&&t.__esModule?()=>t.default:()=>t;return e.d(s,{a:s}),s},d:(t,s)=>{for(var i in s)e.o(s,i)&&!e.o(t,i)&&Object.defineProperty(t,i,{enumerable:!0,get:s[i]})},o:(e,t)=>Object.prototype.hasOwnProperty.call(e,t)};const t=window.wp.element,s=window.wp.apiFetch;var i=e.n(s);const a=window.wp.components,r=window.ReactJSXRuntime,l=({families:e,fetchFamilies:s})=>{const[l,n]=(0,t.useState)(""),[d,o]=(0,t.useState)(""),[c,h]=(0,t.useState)(!1),[x,p]=(0,t.useState)(null),m=()=>{p(null),n(""),o("")};return(0,r.jsxs)("div",{className:"color-families-manager",children:[(0,r.jsxs)(a.PanelBody,{title:x?"Edit Color Family":"Add New Color Family",initialOpen:!0,children:[(0,r.jsx)(a.PanelRow,{children:(0,r.jsx)(a.TextControl,{label:"Family Name (e.g., Blues)",value:l,onChange:e=>n(e)})}),(0,r.jsx)(a.PanelRow,{children:(0,r.jsxs)("div",{style:{display:"flex",alignItems:"center",width:"100%",gap:"15px"},children:[(0,r.jsx)("div",{style:{flex:1},children:(0,r.jsx)(a.TextControl,{label:"Representative Hex Color (e.g., #0000FF)",value:d,onChange:e=>o(e)})}),(0,r.jsx)("div",{className:"color-swatch-box",style:{width:"45px",height:"45px",backgroundColor:d||"#ffffff",marginTop:"15px"}})]})}),(0,r.jsxs)("div",{style:{padding:"10px 20px 20px",display:"flex",gap:"10px"},children:[(0,r.jsx)(a.Button,{variant:"primary",onClick:async()=>{if(l){h(!0);try{x?await i()({path:`/paint-store/v1/families/${x}`,method:"PUT",data:{name:l,hex_representative:d}}):await i()({path:"/paint-store/v1/families",method:"POST",data:{name:l,hex_representative:d}}),n(""),o(""),p(null),s()}catch(e){console.error("Error saving family:",e),alert("Error saving family: "+(e.message||JSON.stringify(e)))}h(!1)}},isBusy:c,disabled:!l||c,children:x?"Update Family":"Add Family"}),x&&(0,r.jsx)(a.Button,{variant:"secondary",onClick:m,children:"Cancel Edit"})]})]}),(0,r.jsxs)("div",{style:{marginTop:"30px"},children:[(0,r.jsx)("h3",{children:"Existing Families"}),(0,r.jsxs)("table",{className:"wp-list-table widefat fixed striped",children:[(0,r.jsx)("thead",{children:(0,r.jsxs)("tr",{children:[(0,r.jsx)("th",{children:"ID"}),(0,r.jsx)("th",{children:"Name"}),(0,r.jsx)("th",{children:"Slug"}),(0,r.jsx)("th",{children:"Color Hex"}),(0,r.jsx)("th",{style:{width:"150px"},children:"Actions"})]})}),(0,r.jsx)("tbody",{children:0===e.length?(0,r.jsx)("tr",{children:(0,r.jsx)("td",{colSpan:"5",children:"No families found."})}):e.map(e=>(0,r.jsxs)("tr",{children:[(0,r.jsx)("td",{children:e.id}),(0,r.jsx)("td",{children:(0,r.jsx)("strong",{children:e.name})}),(0,r.jsx)("td",{children:(0,r.jsx)("code",{children:e.slug})}),(0,r.jsx)("td",{children:(0,r.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:"10px"},children:[(0,r.jsx)("span",{className:"color-swatch-box",style:{display:"inline-block",width:"24px",height:"24px",backgroundColor:e.hex_representative}}),e.hex_representative]})}),(0,r.jsx)("td",{children:(0,r.jsxs)("div",{style:{display:"flex",gap:"10px"},children:[(0,r.jsx)(a.Button,{isSmall:!0,variant:"secondary",onClick:()=>(e=>{p(e.id),n(e.name),o(e.hex_representative)})(e),children:"Edit"}),(0,r.jsx)(a.Button,{isSmall:!0,isDestructive:!0,onClick:()=>(async e=>{if(confirm("Are you sure you want to delete this family?"))try{await i()({path:`/paint-store/v1/families/${e}`,method:"DELETE"}),x===e&&m(),s()}catch(e){console.error("Error deleting family:",e),alert("Error deleting family: "+(e.message||JSON.stringify(e)))}})(e.id),children:"Delete"})]})})]},e.id))})]})]})]})},n=({colors:e,families:s,allBases:l,brands:n,fetchColors:d})=>{const[o,c]=(0,t.useState)(""),[h,x]=(0,t.useState)(""),[p,m]=(0,t.useState)(""),[u,g]=(0,t.useState)(""),[y,j]=(0,t.useState)(""),[f,v]=(0,t.useState)([]),[b,S]=(0,t.useState)(!1),[C,w]=(0,t.useState)(null),[B,E]=(0,t.useState)(""),[N,k]=(0,t.useState)(""),[T,P]=(0,t.useState)(""),[_,I]=(0,t.useState)(1),D=()=>{w(null),c(""),x(""),m(""),g(""),j(""),v([])},O=[{label:"Select a Family...",value:""},...s.map(e=>({label:e.name,value:e.id}))],A=[{label:"Select a Brand...",value:""},...n.map(e=>({label:e.name,value:e.id}))],F=[{label:"All Families",value:""},...s.map(e=>({label:e.name,value:String(e.id)}))],z=[{label:"All Brands",value:""},...n.map(e=>({label:e.name,value:String(e.id)}))],R=(0,t.useMemo)(()=>{let t=e;if(B){const e=B.toLowerCase();t=t.filter(t=>t.name&&t.name.toLowerCase().includes(e)||t.color_code&&t.color_code.toLowerCase().includes(e)||t.hex_value&&t.hex_value.toLowerCase().includes(e))}return N&&(t=t.filter(e=>String(e.brand_id)===N)),T&&(t=t.filter(e=>String(e.family_id)===T)),t},[e,B,N,T]),U=Math.max(1,Math.ceil(R.length/25)),L=Math.min(_,U),J=R.slice(25*(L-1),25*L);return(0,r.jsxs)("div",{className:"colors-manager",style:{marginTop:"30px"},children:[(0,r.jsxs)(a.PanelBody,{title:C?"Edit Specific Color":"Add New Specific Color",initialOpen:!0,children:[(0,r.jsx)(a.PanelRow,{children:(0,r.jsxs)("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"20px",width:"100%"},children:[(0,r.jsx)(a.TextControl,{label:"Color Name (e.g., Naval Blue)",value:o,onChange:e=>c(e)}),(0,r.jsx)(a.TextControl,{label:"Color Code (e.g., SW 6593)",value:h,onChange:e=>x(e)})]})}),(0,r.jsx)(a.PanelRow,{children:(0,r.jsxs)("div",{style:{display:"flex",alignItems:"center",width:"100%",gap:"15px"},children:[(0,r.jsx)("div",{style:{flex:1},children:(0,r.jsx)(a.TextControl,{label:"Hex Value (e.g., #324354)",value:p,onChange:e=>m(e)})}),(0,r.jsx)("div",{className:"color-swatch-box",style:{width:"45px",height:"45px",backgroundColor:p||"#ffffff",marginTop:"15px"}})]})}),(0,r.jsx)(a.PanelRow,{children:(0,r.jsxs)("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"20px",width:"100%"},children:[(0,r.jsx)(a.SelectControl,{label:"Assign to Family",value:u,options:O,onChange:e=>g(e)}),(0,r.jsx)(a.SelectControl,{label:"Assign to Brand",value:y,options:A,onChange:e=>j(e)})]})}),(0,r.jsxs)("div",{style:{marginTop:"15px",padding:"15px 20px"},children:[(0,r.jsx)("p",{style:{fontWeight:600,marginBottom:"10px"},children:"Compatible Bases (Required)"}),0===l.length?(0,r.jsx)("p",{style:{color:"red",fontStyle:"italic"},children:"Please create Paint Bases in the Products & Bases tab first."}):(0,r.jsx)("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr 1fr",gap:"15px"},children:l.map(e=>(0,r.jsx)(a.CheckboxControl,{label:e.name,checked:f.includes(parseInt(e.id)),onChange:()=>{return t=parseInt(e.id),void v(e=>e.includes(t)?e.filter(e=>e!==t):[...e,t]);var t}},e.id))})]}),(0,r.jsxs)("div",{style:{padding:"0 20px 20px",display:"flex",gap:"10px"},children:[(0,r.jsx)(a.Button,{variant:"primary",onClick:async()=>{if(o&&u&&y&&0!==f.length){S(!0);try{const e={name:o,color_code:h,hex_value:p,rgb_value:"",family_id:u,brand_id:y,base_ids:f};C?await i()({path:`/paint-store/v1/colors/${C}`,method:"PUT",data:e}):await i()({path:"/paint-store/v1/colors",method:"POST",data:e}),c(""),x(""),m(""),g(""),j(""),v([]),w(null),d()}catch(e){console.error("Error saving color:",e),alert("Error saving color: "+(e.message||JSON.stringify(e)))}S(!1)}else alert("Name, Family, Brand, and at least one Base are required.")},isBusy:b,disabled:!o||!u||!y||0===f.length||b,children:C?"Update Color":"Add Color"}),C&&(0,r.jsx)(a.Button,{variant:"secondary",onClick:D,children:"Cancel Edit"})]})]}),(0,r.jsxs)("div",{style:{marginTop:"30px"},children:[(0,r.jsx)("h3",{children:"Existing Colors"}),(0,r.jsxs)("div",{style:{display:"grid",gridTemplateColumns:"2fr 1fr 1fr auto",gap:"15px",alignItems:"end",marginBottom:"15px",padding:"15px",background:"#f0f0f1",borderRadius:"6px",border:"1px solid #ddd"},children:[(0,r.jsx)(a.TextControl,{label:"Search by name, code, or hex",value:B,onChange:e=>{E(e),I(1)},placeholder:"e.g. Naval or SW 6593"}),(0,r.jsx)(a.SelectControl,{label:"Filter by Brand",value:N,options:z,onChange:e=>{k(e),I(1)}}),(0,r.jsx)(a.SelectControl,{label:"Filter by Family",value:T,options:F,onChange:e=>{P(e),I(1)}}),(0,r.jsx)(a.Button,{variant:"secondary",isSmall:!0,onClick:()=>{E(""),k(""),P(""),I(1)},style:{marginBottom:"8px"},children:"Clear Filters"})]}),(0,r.jsxs)("p",{style:{color:"#666",marginBottom:"10px"},children:["Showing ",(0,r.jsx)("strong",{children:J.length})," of ",(0,r.jsx)("strong",{children:R.length})," colors",R.length!==e.length&&` (${e.length} total)`," "," â€” Page ",(0,r.jsx)("strong",{children:L})," of ",(0,r.jsx)("strong",{children:U})]}),(0,r.jsxs)("table",{className:"wp-list-table widefat fixed striped",children:[(0,r.jsx)("thead",{children:(0,r.jsxs)("tr",{children:[(0,r.jsx)("th",{children:"ID"}),(0,r.jsx)("th",{children:"Code"}),(0,r.jsx)("th",{children:"Name"}),(0,r.jsx)("th",{children:"Brand"}),(0,r.jsx)("th",{children:"Family"}),(0,r.jsx)("th",{children:"Color Hex"}),(0,r.jsx)("th",{children:"Compatible Bases"}),(0,r.jsx)("th",{style:{width:"150px"},children:"Actions"})]})}),(0,r.jsx)("tbody",{children:0===J.length?(0,r.jsx)("tr",{children:(0,r.jsx)("td",{colSpan:"8",children:"No colors match your filters."})}):J.map(e=>{return(0,r.jsxs)("tr",{children:[(0,r.jsx)("td",{children:e.id}),(0,r.jsx)("td",{children:(0,r.jsx)("strong",{children:e.color_code||"-"})}),(0,r.jsx)("td",{children:(0,r.jsx)("strong",{children:e.name})}),(0,r.jsx)("td",{children:(h=e.brand_id,h?n.find(e=>parseInt(e.id)===parseInt(h))?.name||h:"-")}),(0,r.jsx)("td",{children:(o=e.family_id,o?s.find(e=>parseInt(e.id)===parseInt(o))?.name||o:"-")}),(0,r.jsx)("td",{children:(0,r.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:"10px"},children:[(0,r.jsx)("span",{className:"color-swatch-box",style:{display:"inline-block",width:"24px",height:"24px",backgroundColor:e.hex_value}}),e.hex_value]})}),(0,r.jsx)("td",{children:(0,r.jsx)("em",{children:(t=e.base_ids,t&&0!==t.length?t.map(e=>l.find(t=>parseInt(t.id)===e)?.name||e).join(", "):"None")})}),(0,r.jsx)("td",{children:(0,r.jsxs)("div",{style:{display:"flex",gap:"10px"},children:[(0,r.jsx)(a.Button,{isSmall:!0,variant:"secondary",onClick:()=>(e=>{w(e.id),c(e.name),x(e.color_code||""),m(e.hex_value||""),g(0==e.family_id?"":e.family_id),j(0==e.brand_id?"":e.brand_id),v(e.base_ids||[])})(e),children:"Edit"}),(0,r.jsx)(a.Button,{isSmall:!0,isDestructive:!0,onClick:()=>(async e=>{if(confirm("Are you sure you want to delete this color?"))try{await i()({path:`/paint-store/v1/colors/${e}`,method:"DELETE"}),C===e&&D(),d()}catch(e){console.error("Error deleting color:",e),alert("Error deleting color: "+(e.message||JSON.stringify(e)))}})(e.id),children:"Delete"})]})})]},e.id);var t,o,h})})]}),U>1&&(0,r.jsxs)("div",{style:{display:"flex",justifyContent:"center",alignItems:"center",gap:"8px",marginTop:"20px",padding:"10px"},children:[(0,r.jsx)(a.Button,{variant:"secondary",isSmall:!0,disabled:L<=1,onClick:()=>I(1),children:"Â« First"}),(0,r.jsx)(a.Button,{variant:"secondary",isSmall:!0,disabled:L<=1,onClick:()=>I(e=>Math.max(1,e-1)),children:"â€¹ Prev"}),(0,r.jsxs)("span",{style:{padding:"0 12px",fontWeight:600},children:["Page ",L," of ",U]}),(0,r.jsx)(a.Button,{variant:"secondary",isSmall:!0,disabled:L>=U,onClick:()=>I(e=>Math.min(U,e+1)),children:"Next â€º"}),(0,r.jsx)(a.Button,{variant:"secondary",isSmall:!0,disabled:L>=U,onClick:()=>I(U),children:"Last Â»"})]})]})]})},d=({brands:e,fetchBrands:s})=>{const[l,n]=(0,t.useState)(""),[d,o]=(0,t.useState)(!1),[c,h]=(0,t.useState)(null),x=()=>{h(null),n("")};return(0,r.jsxs)("div",{className:"brands-manager",children:[(0,r.jsxs)(a.PanelBody,{title:c?"Edit Paint Brand":"Add New Paint Brand",initialOpen:!0,children:[(0,r.jsx)(a.PanelRow,{children:(0,r.jsx)(a.TextControl,{label:"Brand Name (e.g., Sherwin Williams, Benjamin Moore)",value:l,onChange:e=>n(e)})}),(0,r.jsxs)("div",{style:{padding:"10px 20px 20px",display:"flex",gap:"10px"},children:[(0,r.jsx)(a.Button,{variant:"primary",onClick:async()=>{if(l){o(!0);try{c?await i()({path:`/paint-store/v1/brands/${c}`,method:"PUT",data:{name:l}}):await i()({path:"/paint-store/v1/brands",method:"POST",data:{name:l}}),n(""),h(null),s()}catch(e){console.error("Error saving brand:",e),alert("Error saving brand: "+(e.message||JSON.stringify(e)))}o(!1)}},isBusy:d,disabled:!l||d,children:c?"Update Brand":"Add Brand"}),c&&(0,r.jsx)(a.Button,{variant:"secondary",onClick:x,children:"Cancel Edit"})]})]}),(0,r.jsxs)("div",{style:{marginTop:"30px"},children:[(0,r.jsx)("h3",{children:"Existing Brands"}),(0,r.jsxs)("table",{className:"wp-list-table widefat fixed striped",children:[(0,r.jsx)("thead",{children:(0,r.jsxs)("tr",{children:[(0,r.jsx)("th",{children:"ID"}),(0,r.jsx)("th",{children:"Name"}),(0,r.jsx)("th",{style:{width:"150px"},children:"Actions"})]})}),(0,r.jsx)("tbody",{children:0===e.length?(0,r.jsx)("tr",{children:(0,r.jsx)("td",{colSpan:"3",children:"No brands found. Add some above."})}):e.map(e=>(0,r.jsxs)("tr",{children:[(0,r.jsx)("td",{children:e.id}),(0,r.jsx)("td",{children:(0,r.jsx)("strong",{children:e.name})}),(0,r.jsx)("td",{children:(0,r.jsxs)("div",{style:{display:"flex",gap:"10px"},children:[(0,r.jsx)(a.Button,{isSmall:!0,variant:"secondary",onClick:()=>(e=>{h(e.id),n(e.name)})(e),children:"Edit"}),(0,r.jsx)(a.Button,{isSmall:!0,isDestructive:!0,onClick:()=>(async e=>{if(confirm("Are you sure you want to delete this brand?"))try{await i()({path:`/paint-store/v1/brands/${e}`,method:"DELETE"}),c===e&&x(),s()}catch(e){console.error("Error deleting brand:",e),alert("Error deleting brand: "+(e.message||JSON.stringify(e)))}})(e.id),children:"Delete"})]})})]},e.id))})]})]})]})},o=({brands:e,families:s,allBases:l,fetchColors:n})=>{const[d,o]=(0,t.useState)([]),[c,h]=(0,t.useState)([]),[x,p]=(0,t.useState)({name:"",color_code:"",hex_value:""}),[m,u]=(0,t.useState)(""),[g,y]=(0,t.useState)(""),[j,f]=(0,t.useState)([]),[v,b]=(0,t.useState)(!1),[S,C]=(0,t.useState)(null),w=(0,t.useRef)(null),B=[{label:"Select a Brand...",value:""},...e.map(e=>({label:e.name,value:String(e.id)}))],E=[{label:"Select a Family...",value:""},...s.map(e=>({label:e.name,value:String(e.id)}))],N=e=>{const t=[];let s="",i=!1;for(let a=0;a<e.length;a++){const r=e[a];'"'===r?i&&a+1<e.length&&'"'===e[a+1]?(s+='"',a++):i=!i:","!==r||i?s+=r:(t.push(s.trim()),s="")}return t.push(s.trim()),t},k=[{label:"â€” Skip â€”",value:""},...c.map(e=>({label:e,value:e}))];return(0,r.jsxs)("div",{className:"color-importer",children:[(0,r.jsx)(a.PanelBody,{title:"Step 1: Upload CSV File",initialOpen:!0,children:(0,r.jsx)(a.PanelRow,{children:(0,r.jsxs)("div",{style:{width:"100%"},children:[(0,r.jsx)("p",{style:{marginBottom:"10px",color:"#666"},children:"Upload a CSV file with your color data. The first row should be column headers."}),(0,r.jsxs)("p",{style:{marginBottom:"15px",color:"#666",fontSize:"12px"},children:[(0,r.jsx)("strong",{children:"Expected columns:"})," Color Name (required), Color Code (optional), Hex Value (optional)"]}),(0,r.jsx)("input",{ref:w,type:"file",accept:".csv,.txt",onChange:e=>{const t=e.target.files[0];if(!t)return;const s=new FileReader;s.onload=e=>{const{headers:t,rows:s}=(e=>{const t=e.split(/\r?\n/).filter(e=>""!==e.trim());if(t.length<2)return{headers:[],rows:[]};const s=t[0],i=N(s),a=[];for(let e=1;e<t.length;e++){const s=N(t[e]);if(s.length>0&&s.some(e=>""!==e.trim())){const e={};i.forEach((t,i)=>{e[t]=s[i]||""}),a.push(e)}}return{headers:i,rows:a}})(e.target.result);h(t),o(s),C(null);const i={name:"",color_code:"",hex_value:""};t.forEach(e=>{const t=e.toLowerCase();t.includes("name")&&!i.name?i.name=e:t.includes("code")&&!i.color_code?i.color_code=e:t.includes("hex")&&!i.hex_value&&(i.hex_value=e)}),p(i)},s.readAsText(t)},style:{marginBottom:"10px"}}),d.length>0&&(0,r.jsxs)("span",{style:{background:"#dff0d8",color:"#3c763d",padding:"4px 12px",borderRadius:"4px",fontSize:"13px",marginLeft:"10px"},children:["âœ“ ",d.length," rows loaded"]})]})})}),d.length>0&&(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(a.PanelBody,{title:"Step 2: Map CSV Columns",initialOpen:!0,children:(0,r.jsx)(a.PanelRow,{children:(0,r.jsxs)("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr 1fr",gap:"20px",width:"100%"},children:[(0,r.jsx)(a.SelectControl,{label:"Color Name Column *",value:x.name,options:k,onChange:e=>p({...x,name:e})}),(0,r.jsx)(a.SelectControl,{label:"Color Code Column",value:x.color_code,options:k,onChange:e=>p({...x,color_code:e})}),(0,r.jsx)(a.SelectControl,{label:"Hex Value Column",value:x.hex_value,options:k,onChange:e=>p({...x,hex_value:e})})]})})}),(0,r.jsxs)(a.PanelBody,{title:"Step 3: Assign Brand, Family & Bases (applied to ALL rows)",initialOpen:!0,children:[(0,r.jsx)(a.PanelRow,{children:(0,r.jsxs)("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"20px",width:"100%"},children:[(0,r.jsx)(a.SelectControl,{label:"Brand *",value:m,options:B,onChange:u}),(0,r.jsx)(a.SelectControl,{label:"Color Family *",value:g,options:E,onChange:y})]})}),(0,r.jsx)(a.PanelRow,{children:(0,r.jsxs)("div",{style:{width:"100%"},children:[(0,r.jsx)("label",{style:{fontWeight:600,display:"block",marginBottom:"8px"},children:"Compatible Bases"}),(0,r.jsx)("div",{style:{display:"flex",gap:"20px",flexWrap:"wrap"},children:l.map(e=>(0,r.jsx)(a.CheckboxControl,{label:e.name,checked:j.includes(parseInt(e.id)),onChange:()=>{return t=parseInt(e.id),void f(e=>e.includes(t)?e.filter(e=>e!==t):[...e,t]);var t}},e.id))})]})})]}),(0,r.jsx)(a.PanelBody,{title:`Step 4: Preview (first 10 of ${d.length} rows)`,initialOpen:!0,children:(0,r.jsxs)("div",{style:{overflowX:"auto"},children:[(0,r.jsxs)("table",{className:"wp-list-table widefat fixed striped",style:{fontSize:"13px"},children:[(0,r.jsx)("thead",{children:(0,r.jsxs)("tr",{children:[(0,r.jsx)("th",{style:{width:"40px"},children:"#"}),(0,r.jsx)("th",{children:"Name"}),(0,r.jsx)("th",{children:"Code"}),(0,r.jsx)("th",{children:"Hex"}),(0,r.jsx)("th",{style:{width:"50px"},children:"Preview"})]})}),(0,r.jsx)("tbody",{children:d.slice(0,10).map((e,t)=>{const s=x.hex_value?e[x.hex_value]:"",i=s&&!s.startsWith("#")?"#"+s:s;return(0,r.jsxs)("tr",{children:[(0,r.jsx)("td",{children:t+1}),(0,r.jsx)("td",{children:(0,r.jsx)("strong",{children:x.name?e[x.name]:"-"})}),(0,r.jsx)("td",{children:x.color_code?e[x.color_code]:"-"}),(0,r.jsx)("td",{children:i||"-"}),(0,r.jsx)("td",{children:i&&(0,r.jsx)("div",{style:{width:"30px",height:"30px",borderRadius:"4px",backgroundColor:i,border:"1px solid #ddd"}})})]},t)})})]}),d.length>10&&(0,r.jsxs)("p",{style:{color:"#666",fontSize:"12px",marginTop:"8px"},children:["...and ",d.length-10," more rows"]})]})}),(0,r.jsxs)("div",{style:{padding:"20px 0",display:"flex",gap:"15px",alignItems:"center"},children:[(0,r.jsx)(a.Button,{variant:"primary",onClick:async()=>{if(!m||!g)return void alert("Please select a Brand and Color Family for all imported colors.");if(!x.name)return void alert('Please map the "Color Name" column.');b(!0),C(null);const e=d.map(e=>({name:e[x.name]||"",color_code:x.color_code&&e[x.color_code]||"",hex_value:x.hex_value&&e[x.hex_value]||"",rgb_value:"",brand_id:parseInt(m),family_id:parseInt(g),base_ids:j}));try{const t=await i()({path:"/paint-store/v1/colors/bulk-import",method:"POST",data:{colors:e}});C(t),t.imported>0&&n()}catch(e){console.error("Bulk import error:",e),C({success:!1,errors:[e.message||JSON.stringify(e)]})}b(!1)},isBusy:v,disabled:v||!x.name||!m||!g,style:{fontSize:"14px",padding:"8px 24px"},children:v?"Importing...":`Import ${d.length} Colors`}),(0,r.jsx)(a.Button,{variant:"secondary",onClick:()=>{o([]),h([]),p({name:"",color_code:"",hex_value:""}),u(""),y(""),f([]),C(null),w.current&&(w.current.value="")},children:"Reset / Start Over"})]}),S&&(0,r.jsxs)("div",{style:{padding:"15px 20px",borderRadius:"6px",marginBottom:"20px",background:S.imported>0?"#dff0d8":"#f2dede",border:"1px solid "+(S.imported>0?"#d6e9c6":"#ebccd1"),color:S.imported>0?"#3c763d":"#a94442"},children:[(0,r.jsx)("strong",{children:S.imported>0?`âœ… Successfully imported ${S.imported} of ${S.total} colors!`:"âŒ Import failed"}),S.errors&&S.errors.length>0&&(0,r.jsxs)("div",{style:{marginTop:"10px",fontSize:"13px"},children:[(0,r.jsx)("strong",{children:"Errors:"}),(0,r.jsx)("ul",{style:{margin:"5px 0 0 20px"},children:S.errors.map((e,t)=>(0,r.jsx)("li",{children:e},t))})]})]})]})]})},c=({bases:e,fetchBases:s})=>{const[l,n]=(0,t.useState)(""),[d,o]=(0,t.useState)(!1),[c,h]=(0,t.useState)(null),x=()=>{h(null),n("")};return(0,r.jsxs)("div",{className:"bases-manager",children:[(0,r.jsxs)(a.PanelBody,{title:c?"Edit Paint Base":"Add New Paint Base",initialOpen:!0,children:[(0,r.jsx)(a.PanelRow,{children:(0,r.jsx)(a.TextControl,{label:"Base Name (e.g., Deep Base, Extra White)",value:l,onChange:e=>n(e)})}),(0,r.jsxs)("div",{style:{padding:"10px 20px 20px",display:"flex",gap:"10px"},children:[(0,r.jsx)(a.Button,{variant:"primary",onClick:async()=>{if(l){o(!0);try{c?await i()({path:`/paint-store/v1/bases/${c}`,method:"PUT",data:{name:l}}):await i()({path:"/paint-store/v1/bases",method:"POST",data:{name:l}}),n(""),h(null),s()}catch(e){console.error("Error saving base:",e),alert("Error saving base: "+(e.message||JSON.stringify(e)))}o(!1)}},isBusy:d,disabled:!l||d,children:c?"Update Base":"Add Base"}),c&&(0,r.jsx)(a.Button,{variant:"secondary",onClick:x,children:"Cancel Edit"})]})]}),(0,r.jsxs)("div",{style:{marginTop:"30px"},children:[(0,r.jsx)("h3",{children:"Existing Bases"}),(0,r.jsxs)("table",{className:"wp-list-table widefat fixed striped",children:[(0,r.jsx)("thead",{children:(0,r.jsxs)("tr",{children:[(0,r.jsx)("th",{children:"ID"}),(0,r.jsx)("th",{children:"Name"}),(0,r.jsx)("th",{style:{width:"150px"},children:"Actions"})]})}),(0,r.jsx)("tbody",{children:0===e.length?(0,r.jsx)("tr",{children:(0,r.jsx)("td",{colSpan:"3",children:"No bases found. Add some above."})}):e.map(e=>(0,r.jsxs)("tr",{children:[(0,r.jsx)("td",{children:e.id}),(0,r.jsx)("td",{children:(0,r.jsx)("strong",{children:e.name})}),(0,r.jsx)("td",{children:(0,r.jsxs)("div",{style:{display:"flex",gap:"10px"},children:[(0,r.jsx)(a.Button,{isSmall:!0,variant:"secondary",onClick:()=>(e=>{h(e.id),n(e.name)})(e),children:"Edit"}),(0,r.jsx)(a.Button,{isSmall:!0,isDestructive:!0,onClick:()=>(async e=>{if(confirm("Are you sure you want to delete this base?"))try{await i()({path:`/paint-store/v1/bases/${e}`,method:"DELETE"}),c===e&&x(),s()}catch(e){console.error("Error deleting base:",e),alert("Error deleting base: "+(e.message||JSON.stringify(e)))}})(e.id),children:"Delete"})]})})]},e.id))})]})]})]})},h=({id:e,label:s,value:i,onChange:a})=>{const l=e||"wp-editor-"+Math.random().toString(36).substr(2,9),n=(0,t.useRef)(null),d=(0,t.useRef)(!1);return(0,t.useEffect)(()=>{const e=setTimeout(()=>{window.wp&&window.wp.oldEditor&&!d.current&&(window.wp.oldEditor.initialize(l,{tinymce:{wpautop:!0,plugins:"charmap colorpicker hr lists paste tabfocus textcolor wordpress wpautoresize wpeditimage wpemoji wpgallery wplink wptextpattern",toolbar1:"formatselect | bold italic underline strikethrough | bullist numlist | blockquote | alignleft aligncenter alignright | link unlink | forecolor | removeformat",toolbar2:"",height:200,setup:e=>{e.on("change keyup",()=>{a(e.getContent())})}},quicktags:!0,mediaButtons:!1}),d.current=!0)},100);return()=>{clearTimeout(e),d.current&&window.wp&&window.wp.oldEditor&&(window.wp.oldEditor.remove(l),d.current=!1)}},[]),(0,t.useEffect)(()=>{if(d.current&&window.tinymce){const e=window.tinymce.get(l);e&&e.getContent()!==i&&e.setContent(i||"")}const e=document.getElementById(l);e&&e.value!==i&&(e.value=i||"")},[i]),(0,r.jsxs)("div",{ref:n,style:{width:"100%"},children:[s&&(0,r.jsx)("label",{style:{display:"block",fontWeight:600,marginBottom:"8px"},children:s}),(0,r.jsx)("textarea",{id:l,defaultValue:i,style:{width:"100%",minHeight:"200px"}})]})},x=({productFamilies:e,brands:s,fetchProductFamilies:l})=>{const[n,d]=(0,t.useState)(""),[o,c]=(0,t.useState)(""),[x,p]=(0,t.useState)(""),[m,u]=(0,t.useState)(0),[g,y]=(0,t.useState)(""),[j,f]=(0,t.useState)(!1),[v,b]=(0,t.useState)(null),S=[{label:"Select a Brand...",value:""},...s.map(e=>({label:e.name,value:e.id}))],C=()=>{const e=wp.media({title:"Select Product Family Image",button:{text:"Use this image"},multiple:!1,library:{type:"image"}});e.on("select",()=>{const t=e.state().get("selection").first().toJSON();u(t.id),y(t.sizes?.medium?.url||t.url)}),e.open()},w=()=>{u(0),y("")},B=()=>{b(null),d(""),c(""),p(""),u(0),y("")};return(0,r.jsxs)("div",{className:"product-families-manager",children:[(0,r.jsxs)(a.PanelBody,{title:v?"Edit Product Family":"Add New Product Family",initialOpen:!0,children:[(0,r.jsx)(a.PanelRow,{children:(0,r.jsxs)("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"20px",width:"100%"},children:[(0,r.jsx)(a.TextControl,{label:"Family Name (e.g., Supreme Edge Interior)",value:n,onChange:d}),(0,r.jsx)(a.SelectControl,{label:"Brand",value:o,options:S,onChange:c})]})}),(0,r.jsx)(a.PanelRow,{children:(0,r.jsxs)("div",{style:{width:"100%"},children:[(0,r.jsx)("label",{style:{display:"block",fontWeight:600,marginBottom:"8px"},children:"Family Image"}),(0,r.jsxs)("div",{style:{display:"flex",alignItems:"flex-start",gap:"15px"},children:[g?(0,r.jsxs)("div",{style:{position:"relative"},children:[(0,r.jsx)("img",{src:g,alt:"Product family",style:{maxWidth:"150px",maxHeight:"150px",borderRadius:"6px",border:"1px solid #ddd",objectFit:"cover"}}),(0,r.jsx)(a.Button,{isSmall:!0,isDestructive:!0,onClick:w,style:{position:"absolute",top:"-8px",right:"-8px",borderRadius:"50%",minWidth:"24px",height:"24px",padding:0},children:"âœ•"})]}):(0,r.jsx)("div",{onClick:C,style:{width:"150px",height:"150px",border:"2px dashed #ccc",borderRadius:"6px",display:"flex",alignItems:"center",justifyContent:"center",cursor:"pointer",color:"#999",fontSize:"13px",textAlign:"center",padding:"10px",transition:"border-color 0.2s"},onMouseEnter:e=>e.currentTarget.style.borderColor="#0073aa",onMouseLeave:e=>e.currentTarget.style.borderColor="#ccc",children:(0,r.jsxs)("span",{children:["ðŸ“·",(0,r.jsx)("br",{}),"Click to upload"]})}),(0,r.jsxs)("div",{style:{display:"flex",flexDirection:"column",gap:"8px"},children:[(0,r.jsx)(a.Button,{variant:"secondary",onClick:C,children:g?"Change Image":"Upload Image"}),g&&(0,r.jsx)(a.Button,{variant:"tertiary",isDestructive:!0,onClick:w,children:"Remove Image"})]})]})]})}),(0,r.jsx)(a.PanelRow,{children:(0,r.jsx)(h,{id:"ps-product-family-desc",label:"Description (optional)",value:x,onChange:p})}),(0,r.jsxs)("div",{style:{padding:"10px 20px 20px",display:"flex",gap:"10px"},children:[(0,r.jsx)(a.Button,{variant:"primary",onClick:async()=>{if(n&&o){f(!0);try{const e={name:n,brand_id:o,description:x,image_id:m};v?await i()({path:`/paint-store/v1/product-families/${v}`,method:"PUT",data:e}):await i()({path:"/paint-store/v1/product-families",method:"POST",data:e}),d(""),c(""),p(""),u(0),y(""),b(null),l()}catch(e){console.error("Error saving product family:",e),alert("Error saving product family: "+(e.message||JSON.stringify(e)))}f(!1)}else alert("Name and Brand are required.")},isBusy:j,disabled:!n||!o||j,children:v?"Update Family":"Add Family"}),v&&(0,r.jsx)(a.Button,{variant:"secondary",onClick:B,children:"Cancel Edit"})]})]}),(0,r.jsxs)("div",{style:{marginTop:"30px"},children:[(0,r.jsx)("h3",{children:"Existing Product Families"}),(0,r.jsxs)("table",{className:"wp-list-table widefat fixed striped",children:[(0,r.jsx)("thead",{children:(0,r.jsxs)("tr",{children:[(0,r.jsx)("th",{style:{width:"50px"},children:"ID"}),(0,r.jsx)("th",{style:{width:"70px"},children:"Image"}),(0,r.jsx)("th",{children:"Name"}),(0,r.jsx)("th",{children:"Brand"}),(0,r.jsx)("th",{children:"Description"}),(0,r.jsx)("th",{style:{width:"150px"},children:"Actions"})]})}),(0,r.jsx)("tbody",{children:0===e.length?(0,r.jsx)("tr",{children:(0,r.jsx)("td",{colSpan:"6",children:"No product families found."})}):e.map(e=>{return(0,r.jsxs)("tr",{children:[(0,r.jsx)("td",{children:e.id}),(0,r.jsx)("td",{children:e.image_url?(0,r.jsx)("img",{src:e.image_url,alt:e.name,style:{width:"50px",height:"50px",objectFit:"cover",borderRadius:"4px"}}):(0,r.jsx)("span",{style:{color:"#999",fontSize:"11px"},children:"No image"})}),(0,r.jsx)("td",{children:(0,r.jsx)("strong",{children:e.name})}),(0,r.jsx)("td",{children:(t=e.brand_id,t?s.find(e=>parseInt(e.id)===parseInt(t))?.name||t:"-")}),(0,r.jsx)("td",{children:(0,r.jsx)("div",{dangerouslySetInnerHTML:{__html:e.description||"-"}})}),(0,r.jsx)("td",{children:(0,r.jsxs)("div",{style:{display:"flex",gap:"10px"},children:[(0,r.jsx)(a.Button,{isSmall:!0,variant:"secondary",onClick:()=>(e=>{b(e.id),d(e.name),c(0==e.brand_id?"":e.brand_id),p(e.description||""),u(e.image_id?parseInt(e.image_id):0),y(e.image_url||"")})(e),children:"Edit"}),(0,r.jsx)(a.Button,{isSmall:!0,isDestructive:!0,onClick:()=>(async e=>{if(confirm("Are you sure you want to delete this product family?"))try{await i()({path:`/paint-store/v1/product-families/${e}`,method:"DELETE"}),v===e&&B(),l()}catch(e){alert("Error deleting product family: "+(e.message||JSON.stringify(e)))}})(e.id),children:"Delete"})]})})]},e.id);var t})})]})]})]})},p=({productCategories:e,fetchProductCategories:s})=>{const[l,n]=(0,t.useState)(""),[d,o]=(0,t.useState)(!1),[c,h]=(0,t.useState)(null),x=()=>{h(null),n("")};return(0,r.jsxs)("div",{className:"product-categories-manager",children:[(0,r.jsxs)(a.PanelBody,{title:c?"Edit Product Category":"Add New Product Category",initialOpen:!0,children:[(0,r.jsx)(a.PanelRow,{children:(0,r.jsx)(a.TextControl,{label:"Category Name (e.g., Paint, Primer, Paint and Primer)",value:l,onChange:n})}),(0,r.jsxs)("div",{style:{padding:"10px 20px 20px",display:"flex",gap:"10px"},children:[(0,r.jsx)(a.Button,{variant:"primary",onClick:async()=>{if(l){o(!0);try{c?await i()({path:`/paint-store/v1/product-categories/${c}`,method:"PUT",data:{name:l}}):await i()({path:"/paint-store/v1/product-categories",method:"POST",data:{name:l}}),n(""),h(null),s()}catch(e){console.error("Error saving product category:",e),alert("Error saving product category: "+(e.message||JSON.stringify(e)))}o(!1)}},isBusy:d,disabled:!l||d,children:c?"Update Category":"Add Category"}),c&&(0,r.jsx)(a.Button,{variant:"secondary",onClick:x,children:"Cancel Edit"})]})]}),(0,r.jsxs)("div",{style:{marginTop:"30px"},children:[(0,r.jsx)("h3",{children:"Existing Product Categories"}),(0,r.jsxs)("table",{className:"wp-list-table widefat fixed striped",children:[(0,r.jsx)("thead",{children:(0,r.jsxs)("tr",{children:[(0,r.jsx)("th",{children:"ID"}),(0,r.jsx)("th",{children:"Name"}),(0,r.jsx)("th",{children:"Slug"}),(0,r.jsx)("th",{style:{width:"150px"},children:"Actions"})]})}),(0,r.jsx)("tbody",{children:0===e.length?(0,r.jsx)("tr",{children:(0,r.jsx)("td",{colSpan:"4",children:"No product categories found."})}):e.map(e=>(0,r.jsxs)("tr",{children:[(0,r.jsx)("td",{children:e.id}),(0,r.jsx)("td",{children:(0,r.jsx)("strong",{children:e.name})}),(0,r.jsx)("td",{children:(0,r.jsx)("code",{children:e.slug})}),(0,r.jsx)("td",{children:(0,r.jsxs)("div",{style:{display:"flex",gap:"10px"},children:[(0,r.jsx)(a.Button,{isSmall:!0,variant:"secondary",onClick:()=>(e=>{h(e.id),n(e.name)})(e),children:"Edit"}),(0,r.jsx)(a.Button,{isSmall:!0,isDestructive:!0,onClick:()=>(async e=>{if(confirm("Are you sure you want to delete this product category?"))try{await i()({path:`/paint-store/v1/product-categories/${e}`,method:"DELETE"}),c===e&&x(),s()}catch(e){alert("Error deleting product category: "+(e.message||JSON.stringify(e)))}})(e.id),children:"Delete"})]})})]},e.id))})]})]})]})},m=({sizes:e,fetchSizes:s})=>{const[l,n]=(0,t.useState)(""),[d,o]=(0,t.useState)(""),[c,h]=(0,t.useState)(!1),[x,p]=(0,t.useState)(null),m=()=>{p(null),n(""),o("")};return(0,r.jsxs)("div",{className:"sizes-manager",children:[(0,r.jsxs)(a.PanelBody,{title:x?"Edit Size":"Add New Size",initialOpen:!0,children:[(0,r.jsx)(a.PanelRow,{children:(0,r.jsxs)("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"20px",width:"100%"},children:[(0,r.jsx)(a.TextControl,{label:"Size Name (e.g., 1 Gallon, 5 Gallon)",value:l,onChange:n}),(0,r.jsx)(a.TextControl,{label:"Liters (e.g., 3.78)",value:d,onChange:o,type:"number",step:"0.01"})]})}),(0,r.jsxs)("div",{style:{padding:"10px 20px 20px",display:"flex",gap:"10px"},children:[(0,r.jsx)(a.Button,{variant:"primary",onClick:async()=>{if(l){h(!0);try{const e={name:l,liters:parseFloat(d)||0};x?await i()({path:`/paint-store/v1/sizes/${x}`,method:"PUT",data:e}):await i()({path:"/paint-store/v1/sizes",method:"POST",data:e}),n(""),o(""),p(null),s()}catch(e){console.error("Error saving size:",e),alert("Error saving size: "+(e.message||JSON.stringify(e)))}h(!1)}},isBusy:c,disabled:!l||c,children:x?"Update Size":"Add Size"}),x&&(0,r.jsx)(a.Button,{variant:"secondary",onClick:m,children:"Cancel Edit"})]})]}),(0,r.jsxs)("div",{style:{marginTop:"30px"},children:[(0,r.jsx)("h3",{children:"Existing Sizes"}),(0,r.jsxs)("table",{className:"wp-list-table widefat fixed striped",children:[(0,r.jsx)("thead",{children:(0,r.jsxs)("tr",{children:[(0,r.jsx)("th",{children:"ID"}),(0,r.jsx)("th",{children:"Name"}),(0,r.jsx)("th",{children:"Liters"}),(0,r.jsx)("th",{style:{width:"150px"},children:"Actions"})]})}),(0,r.jsx)("tbody",{children:0===e.length?(0,r.jsx)("tr",{children:(0,r.jsx)("td",{colSpan:"4",children:"No sizes found."})}):e.map(e=>(0,r.jsxs)("tr",{children:[(0,r.jsx)("td",{children:e.id}),(0,r.jsx)("td",{children:(0,r.jsx)("strong",{children:e.name})}),(0,r.jsxs)("td",{children:[e.liters,"L"]}),(0,r.jsx)("td",{children:(0,r.jsxs)("div",{style:{display:"flex",gap:"10px"},children:[(0,r.jsx)(a.Button,{isSmall:!0,variant:"secondary",onClick:()=>(e=>{p(e.id),n(e.name),o(e.liters||"")})(e),children:"Edit"}),(0,r.jsx)(a.Button,{isSmall:!0,isDestructive:!0,onClick:()=>(async e=>{if(confirm("Are you sure you want to delete this size?"))try{await i()({path:`/paint-store/v1/sizes/${e}`,method:"DELETE"}),x===e&&m(),s()}catch(e){alert("Error deleting size: "+(e.message||JSON.stringify(e)))}})(e.id),children:"Delete"})]})})]},e.id))})]})]})]})},u=({sheens:e,fetchSheens:s})=>{const[l,n]=(0,t.useState)(""),[d,o]=(0,t.useState)(!1),[c,h]=(0,t.useState)(null),x=()=>{h(null),n("")};return(0,r.jsxs)("div",{className:"sheens-manager",children:[(0,r.jsxs)(a.PanelBody,{title:c?"Edit Sheen":"Add New Sheen",initialOpen:!0,children:[(0,r.jsx)(a.PanelRow,{children:(0,r.jsx)(a.TextControl,{label:"Sheen Name (e.g., Flat, Eggshell, Satin)",value:l,onChange:n})}),(0,r.jsxs)("div",{style:{padding:"10px 20px 20px",display:"flex",gap:"10px"},children:[(0,r.jsx)(a.Button,{variant:"primary",onClick:async()=>{if(l){o(!0);try{c?await i()({path:`/paint-store/v1/sheens/${c}`,method:"PUT",data:{name:l}}):await i()({path:"/paint-store/v1/sheens",method:"POST",data:{name:l}}),n(""),h(null),s()}catch(e){console.error("Error saving sheen:",e),alert("Error saving sheen: "+(e.message||JSON.stringify(e)))}o(!1)}},isBusy:d,disabled:!l||d,children:c?"Update Sheen":"Add Sheen"}),c&&(0,r.jsx)(a.Button,{variant:"secondary",onClick:x,children:"Cancel Edit"})]})]}),(0,r.jsxs)("div",{style:{marginTop:"30px"},children:[(0,r.jsx)("h3",{children:"Existing Sheens"}),(0,r.jsxs)("table",{className:"wp-list-table widefat fixed striped",children:[(0,r.jsx)("thead",{children:(0,r.jsxs)("tr",{children:[(0,r.jsx)("th",{children:"ID"}),(0,r.jsx)("th",{children:"Name"}),(0,r.jsx)("th",{style:{width:"150px"},children:"Actions"})]})}),(0,r.jsx)("tbody",{children:0===e.length?(0,r.jsx)("tr",{children:(0,r.jsx)("td",{colSpan:"3",children:"No sheens found."})}):e.map(e=>(0,r.jsxs)("tr",{children:[(0,r.jsx)("td",{children:e.id}),(0,r.jsx)("td",{children:(0,r.jsx)("strong",{children:e.name})}),(0,r.jsx)("td",{children:(0,r.jsxs)("div",{style:{display:"flex",gap:"10px"},children:[(0,r.jsx)(a.Button,{isSmall:!0,variant:"secondary",onClick:()=>(e=>{h(e.id),n(e.name)})(e),children:"Edit"}),(0,r.jsx)(a.Button,{isSmall:!0,isDestructive:!0,onClick:()=>(async e=>{if(confirm("Are you sure you want to delete this sheen?"))try{await i()({path:`/paint-store/v1/sheens/${e}`,method:"DELETE"}),c===e&&x(),s()}catch(e){alert("Error deleting sheen: "+(e.message||JSON.stringify(e)))}})(e.id),children:"Delete"})]})})]},e.id))})]})]})]})},g=({surfaceTypes:e,fetchSurfaceTypes:s})=>{const[l,n]=(0,t.useState)(""),[d,o]=(0,t.useState)(!1),[c,h]=(0,t.useState)(null),x=()=>{h(null),n("")};return(0,r.jsxs)("div",{className:"surface-types-manager",children:[(0,r.jsxs)(a.PanelBody,{title:c?"Edit Surface Type":"Add New Surface Type",initialOpen:!0,children:[(0,r.jsx)(a.PanelRow,{children:(0,r.jsx)(a.TextControl,{label:"Surface Type (e.g., Interior Walls, Exterior, Deck)",value:l,onChange:n})}),(0,r.jsxs)("div",{style:{padding:"10px 20px 20px",display:"flex",gap:"10px"},children:[(0,r.jsx)(a.Button,{variant:"primary",onClick:async()=>{if(l){o(!0);try{c?await i()({path:`/paint-store/v1/surface-types/${c}`,method:"PUT",data:{name:l}}):await i()({path:"/paint-store/v1/surface-types",method:"POST",data:{name:l}}),n(""),h(null),s()}catch(e){console.error("Error saving surface type:",e),alert("Error saving surface type: "+(e.message||JSON.stringify(e)))}o(!1)}},isBusy:d,disabled:!l||d,children:c?"Update Surface Type":"Add Surface Type"}),c&&(0,r.jsx)(a.Button,{variant:"secondary",onClick:x,children:"Cancel Edit"})]})]}),(0,r.jsxs)("div",{style:{marginTop:"30px"},children:[(0,r.jsx)("h3",{children:"Existing Surface Types"}),(0,r.jsxs)("table",{className:"wp-list-table widefat fixed striped",children:[(0,r.jsx)("thead",{children:(0,r.jsxs)("tr",{children:[(0,r.jsx)("th",{children:"ID"}),(0,r.jsx)("th",{children:"Name"}),(0,r.jsx)("th",{style:{width:"150px"},children:"Actions"})]})}),(0,r.jsx)("tbody",{children:0===e.length?(0,r.jsx)("tr",{children:(0,r.jsx)("td",{colSpan:"3",children:"No surface types found."})}):e.map(e=>(0,r.jsxs)("tr",{children:[(0,r.jsx)("td",{children:e.id}),(0,r.jsx)("td",{children:(0,r.jsx)("strong",{children:e.name})}),(0,r.jsx)("td",{children:(0,r.jsxs)("div",{style:{display:"flex",gap:"10px"},children:[(0,r.jsx)(a.Button,{isSmall:!0,variant:"secondary",onClick:()=>(e=>{h(e.id),n(e.name)})(e),children:"Edit"}),(0,r.jsx)(a.Button,{isSmall:!0,isDestructive:!0,onClick:()=>(async e=>{if(confirm("Are you sure you want to delete this surface type?"))try{await i()({path:`/paint-store/v1/surface-types/${e}`,method:"DELETE"}),c===e&&x(),s()}catch(e){alert("Error deleting surface type: "+(e.message||JSON.stringify(e)))}})(e.id),children:"Delete"})]})})]},e.id))})]})]})]})},y=({sceneImages:e,fetchSceneImages:s})=>{const[l,n]=(0,t.useState)(""),[d,o]=(0,t.useState)(0),[c,h]=(0,t.useState)(""),[x,p]=(0,t.useState)(!1),[m,u]=(0,t.useState)(null),g=()=>{const e=wp.media({title:"Select Scene Image (transparent PNG)",button:{text:"Use this image"},multiple:!1,library:{type:"image"}});e.on("select",()=>{const t=e.state().get("selection").first().toJSON();o(t.id),h(t.sizes?.medium?.url||t.url)}),e.open()},y=()=>{o(0),h("")},j=()=>{u(null),n(""),o(0),h("")};return(0,r.jsxs)("div",{className:"scene-images-manager",children:[(0,r.jsxs)(a.PanelBody,{title:m?"Edit Scene Image":"Add New Scene Image",initialOpen:!0,children:[(0,r.jsx)(a.PanelRow,{children:(0,r.jsx)(a.TextControl,{label:"Scene Name (e.g., Modern Living Room, Cozy Bedroom)",value:l,onChange:n,style:{width:"100%"}})}),(0,r.jsx)(a.PanelRow,{children:(0,r.jsxs)("div",{style:{width:"100%"},children:[(0,r.jsx)("label",{style:{display:"block",fontWeight:600,marginBottom:"8px"},children:"Scene Image (transparent PNG with walls removed)"}),(0,r.jsxs)("div",{style:{display:"flex",alignItems:"flex-start",gap:"15px"},children:[c?(0,r.jsxs)("div",{style:{position:"relative"},children:[(0,r.jsx)("div",{style:{background:"repeating-conic-gradient(#ddd 0% 25%, #fff 0% 50%) 50% / 16px 16px",borderRadius:"8px",border:"1px solid #ddd",overflow:"hidden"},children:(0,r.jsx)("img",{src:c,alt:l||"Scene preview",style:{maxWidth:"300px",maxHeight:"200px",display:"block",objectFit:"contain"}})}),(0,r.jsx)(a.Button,{isSmall:!0,isDestructive:!0,onClick:y,style:{position:"absolute",top:"-8px",right:"-8px",borderRadius:"50%",minWidth:"24px",height:"24px",padding:0},children:"âœ•"})]}):(0,r.jsx)("div",{onClick:g,style:{width:"300px",height:"200px",border:"2px dashed #ccc",borderRadius:"8px",display:"flex",alignItems:"center",justifyContent:"center",cursor:"pointer",color:"#999",fontSize:"14px",textAlign:"center",padding:"20px",transition:"border-color 0.2s",background:"repeating-conic-gradient(#f5f5f5 0% 25%, #fff 0% 50%) 50% / 16px 16px"},onMouseEnter:e=>e.currentTarget.style.borderColor="#0073aa",onMouseLeave:e=>e.currentTarget.style.borderColor="#ccc",children:(0,r.jsxs)("span",{children:["ðŸ–¼ï¸",(0,r.jsx)("br",{}),"Click to upload scene image",(0,r.jsx)("br",{}),(0,r.jsx)("small",{children:"(transparent PNG)"})]})}),(0,r.jsxs)("div",{style:{display:"flex",flexDirection:"column",gap:"8px"},children:[(0,r.jsx)(a.Button,{variant:"secondary",onClick:g,children:c?"Change Image":"Upload Image"}),c&&(0,r.jsx)(a.Button,{variant:"tertiary",isDestructive:!0,onClick:y,children:"Remove Image"})]})]}),(0,r.jsx)("p",{style:{color:"#666",fontSize:"12px",marginTop:"8px"},children:"Upload a PNG image of a room with the wall areas made transparent. On the frontend, the selected paint color will show through the transparent wall areas."})]})}),(0,r.jsxs)("div",{style:{padding:"10px 20px 20px",display:"flex",gap:"10px"},children:[(0,r.jsx)(a.Button,{variant:"primary",onClick:async()=>{if(l&&d){p(!0);try{const e={name:l,image_id:d};m?await i()({path:`/paint-store/v1/scene-images/${m}`,method:"PUT",data:e}):await i()({path:"/paint-store/v1/scene-images",method:"POST",data:e}),n(""),o(0),h(""),u(null),s()}catch(e){console.error("Error saving scene image:",e),alert("Error saving scene image: "+(e.message||JSON.stringify(e)))}p(!1)}else alert("Name and Image are required.")},isBusy:x,disabled:!l||!d||x,children:m?"Update Scene":"Add Scene"}),m&&(0,r.jsx)(a.Button,{variant:"secondary",onClick:j,children:"Cancel Edit"})]})]}),(0,r.jsxs)("div",{style:{marginTop:"30px"},children:[(0,r.jsx)("h3",{children:"Existing Scene Images"}),(0,r.jsx)("p",{style:{color:"#666",marginBottom:"15px"},children:"These scenes are available for the Color Visualizer â€” customers can preview any color on these room scenes."}),(0,r.jsx)("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fill, minmax(280px, 1fr))",gap:"20px"},children:0===e.length?(0,r.jsx)("p",{style:{color:"#999"},children:"No scene images yet. Upload your first room scene above."}):e.map(e=>(0,r.jsxs)("div",{style:{border:"1px solid #ddd",borderRadius:"8px",overflow:"hidden",background:"#fff",boxShadow:"0 1px 3px rgba(0,0,0,0.08)"},children:[(0,r.jsx)("div",{style:{height:"180px",background:"repeating-conic-gradient(#eee 0% 25%, #fff 0% 50%) 50% / 16px 16px",display:"flex",alignItems:"center",justifyContent:"center"},children:e.image_url?(0,r.jsx)("img",{src:e.image_url,alt:e.name,style:{maxWidth:"100%",maxHeight:"180px",objectFit:"contain"}}):(0,r.jsx)("span",{style:{color:"#999"},children:"No image"})}),(0,r.jsxs)("div",{style:{padding:"12px 16px",borderTop:"1px solid #eee"},children:[(0,r.jsx)("strong",{style:{fontSize:"14px"},children:e.name}),(0,r.jsxs)("div",{style:{marginTop:"10px",display:"flex",gap:"8px"},children:[(0,r.jsx)(a.Button,{isSmall:!0,variant:"secondary",onClick:()=>(e=>{u(e.id),n(e.name),o(e.image_id?parseInt(e.image_id):0),h(e.image_url||"")})(e),children:"Edit"}),(0,r.jsx)(a.Button,{isSmall:!0,isDestructive:!0,onClick:()=>(async e=>{if(confirm("Are you sure you want to delete this scene image?"))try{await i()({path:`/paint-store/v1/scene-images/${e}`,method:"DELETE"}),m===e&&j(),s()}catch(e){alert("Error deleting scene image: "+(e.message||JSON.stringify(e)))}})(e.id),children:"Delete"})]})]})]},e.id))})]})]})},j=()=>{const[e,s]=(0,t.useState)("colors"),[a,h]=(0,t.useState)("brands"),[j,f]=(0,t.useState)("bases"),[v,b]=(0,t.useState)(""),[S,C]=(0,t.useState)(!1),[w,B]=(0,t.useState)([]),[E,N]=(0,t.useState)([]),[k,T]=(0,t.useState)([]),[P,_]=(0,t.useState)([]),[I,D]=(0,t.useState)([]),[O,A]=(0,t.useState)([]),[F,z]=(0,t.useState)([]),[R,U]=(0,t.useState)([]),[L,J]=(0,t.useState)([]),[$,M]=(0,t.useState)([]);(0,t.useEffect)(()=>{W(),H(),V(),q(),G(),X(),K(),Q(),Y(),Z()},[]);const W=async()=>{try{const e=await i()({path:"/paint-store/v1/brands"});B(e)}catch(e){console.error("Error fetching brands:",e)}},H=async()=>{try{const e=await i()({path:"/paint-store/v1/families"});N(e)}catch(e){console.error("Error fetching families:",e)}},V=async()=>{try{const e=await i()({path:"/paint-store/v1/bases"});T(e)}catch(e){console.error("Error fetching bases:",e)}},q=async()=>{try{const e=await i()({path:"/paint-store/v1/colors"});_(e)}catch(e){console.error("Error fetching colors:",e)}},G=async()=>{try{const e=await i()({path:"/paint-store/v1/product-families"});D(e)}catch(e){console.error("Error fetching product families:",e)}},X=async()=>{try{const e=await i()({path:"/paint-store/v1/product-categories"});A(e)}catch(e){console.error("Error fetching product categories:",e)}},K=async()=>{try{const e=await i()({path:"/paint-store/v1/sizes"});z(e)}catch(e){console.error("Error fetching sizes:",e)}},Q=async()=>{try{const e=await i()({path:"/paint-store/v1/sheens"});U(e)}catch(e){console.error("Error fetching sheens:",e)}},Y=async()=>{try{const e=await i()({path:"/paint-store/v1/surface-types"});J(e)}catch(e){console.error("Error fetching surface types:",e)}},Z=async()=>{try{const e=await i()({path:"/paint-store/v1/scene-images"});M(e)}catch(e){console.error("Error fetching scene images:",e)}},ee=[{key:"bases",label:"Paint Bases"},{key:"product-families",label:"Product Families"},{key:"product-categories",label:"Product Categories"},{key:"sizes",label:"Sizes"},{key:"sheens",label:"Sheens"},{key:"surface-types",label:"Surface Types"},{key:"scene-images",label:"Scene Images"}];return(0,r.jsxs)("div",{className:"paint-store-admin-wrap",children:[(0,r.jsx)("h1",{children:"Paint Store Management"}),(0,r.jsxs)("div",{className:"nav-tab-wrapper",style:{marginBottom:"20px"},children:[(0,r.jsx)("button",{className:"nav-tab "+("colors"===e?"nav-tab-active":""),onClick:()=>s("colors"),children:"Colors & Families"}),(0,r.jsx)("button",{className:"nav-tab "+("products"===e?"nav-tab-active":""),onClick:()=>s("products"),children:"Products & Bases"}),(0,r.jsx)("button",{className:"nav-tab "+("settings"===e?"nav-tab-active":""),onClick:()=>s("settings"),children:"Settings"})]}),(0,r.jsxs)("div",{className:"tab-content",children:["colors"===e&&(0,r.jsxs)("div",{children:[(0,r.jsxs)("ul",{className:"subsubsub",style:{marginBottom:"20px",fontSize:"14px"},children:[(0,r.jsxs)("li",{children:[(0,r.jsx)("a",{href:"#",className:"brands"===a?"current":"",onClick:e=>{e.preventDefault(),h("brands")},children:"Paint Brands"})," |"]}),(0,r.jsxs)("li",{children:[(0,r.jsx)("a",{href:"#",className:"families"===a?"current":"",onClick:e=>{e.preventDefault(),h("families")},children:"Color Families"})," |"]}),(0,r.jsxs)("li",{children:[(0,r.jsx)("a",{href:"#",className:"colors"===a?"current":"",onClick:e=>{e.preventDefault(),h("colors")},children:"Specific Colors"})," |"]}),(0,r.jsx)("li",{children:(0,r.jsx)("a",{href:"#",className:"import"===a?"current":"",onClick:e=>{e.preventDefault(),h("import")},children:"ðŸ“¥ Import Colors"})})]}),(0,r.jsx)("div",{className:"clear"}),"brands"===a&&(0,r.jsx)(d,{brands:w,fetchBrands:W}),"families"===a&&(0,r.jsx)(l,{families:E,fetchFamilies:H}),"colors"===a&&(0,r.jsx)(n,{colors:P,families:E,allBases:k,brands:w,fetchColors:q}),"import"===a&&(0,r.jsx)(o,{brands:w,families:E,allBases:k,fetchColors:q})]}),"products"===e&&(0,r.jsxs)("div",{children:[(0,r.jsx)("ul",{className:"subsubsub",style:{marginBottom:"20px",fontSize:"14px"},children:ee.map((e,t)=>(0,r.jsxs)("li",{children:[(0,r.jsx)("a",{href:"#",className:j===e.key?"current":"",onClick:t=>{t.preventDefault(),f(e.key)},children:e.label}),t<ee.length-1?" | ":""]},e.key))}),(0,r.jsx)("div",{className:"clear"}),"bases"===j&&(0,r.jsx)(c,{bases:k,fetchBases:V}),"product-families"===j&&(0,r.jsx)(x,{productFamilies:I,brands:w,fetchProductFamilies:G}),"product-categories"===j&&(0,r.jsx)(p,{productCategories:O,fetchProductCategories:X}),"sizes"===j&&(0,r.jsx)(m,{sizes:F,fetchSizes:K}),"sheens"===j&&(0,r.jsx)(u,{sheens:R,fetchSheens:Q}),"surface-types"===j&&(0,r.jsx)(g,{surfaceTypes:L,fetchSurfaceTypes:Y}),"scene-images"===j&&(0,r.jsx)(y,{sceneImages:$,fetchSceneImages:Z})]}),"settings"===e&&(0,r.jsxs)("div",{children:[(0,r.jsx)("h2",{children:"Store Settings"}),(0,r.jsx)("p",{children:"General store settings."}),(0,r.jsx)("hr",{style:{margin:"40px 0"}}),(0,r.jsx)("h3",{children:"Advanced Tools"}),(0,r.jsx)("p",{children:"If you recently updated the plugin, you may need to initialize or upgrade the database tables."}),(0,r.jsx)("button",{className:"button button-primary",onClick:async()=>{C(!0),b("Running database upgrade...");try{const e=await i()({path:"/paint-store/v1/upgrade-db"});b(JSON.stringify(e,null,2))}catch(e){console.error("Error upgrading DB:",e),b("Error: "+(e.message||JSON.stringify(e)))}C(!1)},disabled:S,children:S?"Upgrading...":"Initialize / Upgrade Database"}),v&&(0,r.jsx)("pre",{style:{marginTop:"20px",padding:"15px",background:"#f0f0f1",border:"1px solid #ccc",overflow:"auto",maxHeight:"400px"},children:v})]})]})]})};document.addEventListener("DOMContentLoaded",()=>{const e=document.getElementById("paint-store-admin-root");e&&(0,t.render)((0,r.jsx)(j,{}),e)})})();