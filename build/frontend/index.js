(()=>{"use strict";var e={n:t=>{var i=t&&t.__esModule?()=>t.default:()=>t;return e.d(i,{a:i}),i},d:(t,i)=>{for(var o in i)e.o(i,o)&&!e.o(t,o)&&Object.defineProperty(t,o,{enumerable:!0,get:i[o]})},o:(e,t)=>Object.prototype.hasOwnProperty.call(e,t)};const t=window.wp.element,i=window.wp.apiFetch;var o=e.n(i);const s=window.ReactJSXRuntime,l=({imageUrl:e,selectedColor:t})=>(0,s.jsx)("div",{className:"ps-visualizer",children:e?(0,s.jsxs)("div",{className:"ps-visualizer-container",style:{position:"relative",width:"100%",paddingTop:"75%",backgroundColor:"#eee",overflow:"hidden",borderRadius:"8px"},children:[(0,s.jsx)("img",{src:e,alt:"Room Scene",style:{position:"absolute",top:0,left:0,width:"100%",height:"100%",objectFit:"cover",zIndex:1}}),t&&(0,s.jsx)("div",{className:"ps-color-overlay",style:{position:"absolute",top:0,left:0,width:"100%",height:"100%",backgroundColor:t.hex_value,mixBlendMode:"multiply",zIndex:2}})]}):(0,s.jsx)("div",{style:{padding:"40px",textAlign:"center",background:"#eee",borderRadius:"8px"},children:(0,s.jsx)("p",{children:"No scene image available."})})}),a=({colors:e,selectedColor:i,onColorSelect:o})=>{const[l,a]=(0,t.useState)(""),r=(0,t.useMemo)(()=>{if(!l)return e;const t=l.toLowerCase();return e.filter(e=>e.name.toLowerCase().includes(t)||e.color_code.toLowerCase().includes(t))},[e,l]);return(0,s.jsxs)("div",{className:"ps-color-browser",children:[(0,s.jsx)("h3",{children:"Select a Color"}),(0,s.jsx)("input",{type:"text",placeholder:"Search colors by name or code...",value:l,onChange:e=>a(e.target.value),style:{width:"100%",padding:"10px",marginBottom:"15px"}}),(0,s.jsxs)("div",{className:"ps-color-grid",style:{display:"grid",gridTemplateColumns:"repeat(auto-fill, minmax(80px, 1fr))",gap:"10px",maxHeight:"300px",overflowY:"auto"},children:[r.map(e=>(0,s.jsxs)("div",{className:"ps-color-swatch "+(i?.id===e.id?"selected":""),onClick:()=>o(e),style:{cursor:"pointer",border:i?.id===e.id?"2px solid #000":"1px solid #ddd",borderRadius:"4px",overflow:"hidden",textAlign:"center",fontSize:"11px",boxShadow:i?.id===e.id?"0 0 5px rgba(0,0,0,0.3)":"none"},children:[(0,s.jsx)("div",{style:{backgroundColor:e.hex_value,height:"60px",width:"100%"}}),(0,s.jsxs)("div",{style:{padding:"5px"},children:[(0,s.jsx)("div",{style:{fontWeight:"bold"},children:e.color_code}),(0,s.jsx)("div",{style:{whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis"},children:e.name})]})]},e.id)),0===r.length&&(0,s.jsx)("p",{children:"No colors found."})]})]})},r=({attributes:e,selectedSize:t,setSelectedSize:i,selectedSheen:o,setSelectedSheen:l})=>(0,s.jsxs)("div",{className:"ps-product-options",style:{marginTop:"20px"},children:[e.sizes&&e.sizes.length>0&&(0,s.jsxs)("div",{style:{marginBottom:"15px"},children:[(0,s.jsx)("label",{style:{display:"block",fontWeight:"bold",marginBottom:"5px"},children:"Size"}),(0,s.jsxs)("select",{value:t,onChange:e=>i(e.target.value),style:{width:"100%",padding:"10px",fontSize:"16px"},children:[(0,s.jsx)("option",{value:"",children:"Choose an option"}),e.sizes.map(e=>(0,s.jsx)("option",{value:e.slug,children:e.name},e.slug))]})]}),e.sheens&&e.sheens.length>0&&(0,s.jsxs)("div",{style:{marginBottom:"15px"},children:[(0,s.jsx)("label",{style:{display:"block",fontWeight:"bold",marginBottom:"5px"},children:"Sheen"}),(0,s.jsxs)("select",{value:o,onChange:e=>l(e.target.value),style:{width:"100%",padding:"10px",fontSize:"16px"},children:[(0,s.jsx)("option",{value:"",children:"Choose an option"}),e.sheens.map(e=>(0,s.jsx)("option",{value:e.slug,children:e.name},e.slug))]})]})]}),d=({familyId:e,variations:i,selectedSize:l,selectedSheen:a,selectedColor:r})=>{const[d,n]=(0,t.useState)(!1),[c,p]=(0,t.useState)("");let u="";if(l&&a){const e=i.find(e=>e.attributes.attribute_pa_paint_size===l&&e.attributes.attribute_pa_paint_sheen===a);e&&e.price_html&&(u=e.price_html)}return(0,s.jsxs)("div",{className:"ps-add-to-cart-wrapper",style:{marginTop:"30px",padding:"20px",background:"#f5f5f5",borderRadius:"8px"},children:[(0,s.jsx)("div",{style:{marginBottom:"15px"},dangerouslySetInnerHTML:{__html:u}}),(0,s.jsx)("button",{className:"button alt",onClick:async()=>{if(!l||!a)return void p("Please select a Size and Sheen.");if(!r)return void p("Please select a Color.");const t=i.find(e=>e.attributes.attribute_pa_paint_size===l&&e.attributes.attribute_pa_paint_sheen===a);if(t){n(!0),p("");try{(await o()({path:"/paint-store/v1/public/add-to-cart",method:"POST",data:{product_id:e,variation_id:t.id,quantity:1,color_hex:r.hex_value,color_name:`${r.name} (${r.color_code})`}})).success?(p("✅ Added to cart successfully!"),"undefined"!=typeof jQuery&&(jQuery(document.body).trigger("wc_fragment_refresh"),jQuery(document.body).trigger("added_to_cart"))):p("❌ Failed to add to cart.")}catch(e){console.error("Error adding to cart:",e),p(`❌ Error: ${e.message||"Failed to add to cart."}`)}n(!1)}else p("This combination of size and sheen is currently unavailable.")},disabled:d||!l||!a||!r,style:{width:"100%",padding:"15px",fontSize:"18px",fontWeight:"bold"},children:d?"Adding...":"Add to Cart"}),c&&(0,s.jsx)("div",{style:{marginTop:"15px",fontWeight:"bold",color:c.includes("✅")?"#0f834d":"#d63638"},children:c})]})},n=({familyId:e})=>{const[i,n]=(0,t.useState)(!0),[c,p]=(0,t.useState)(null),[u,h]=(0,t.useState)([]),[x,m]=(0,t.useState)(""),[g,y]=(0,t.useState)(""),[v,f]=(0,t.useState)(null);return(0,t.useEffect)(()=>{e&&(async()=>{try{const[t,i]=await Promise.all([o()({path:`/paint-store/v1/public/product-families/${e}`}),o()({path:"/paint-store/v1/public/colors"})]);p(t),h(i)}catch(e){console.error("Error fetching builder data:",e)}finally{n(!1)}})()},[e]),e?i?(0,s.jsx)("div",{className:"ps-builder-loading",style:{padding:"40px",textAlign:"center"},children:"Loading Product Data..."}):c&&c.family?(0,s.jsxs)("div",{className:"paint-store-product-builder",children:[(0,s.jsx)("h2",{style:{marginBottom:"5px"},children:c.family.name}),(0,s.jsx)("p",{style:{color:"#666",marginTop:0},dangerouslySetInnerHTML:{__html:c.family.description}}),(0,s.jsxs)("div",{style:{display:"flex",flexWrap:"wrap",gap:"30px",marginTop:"30px"},children:[(0,s.jsxs)("div",{style:{flex:"1 1 300px",maxWidth:"400px"},children:[(0,s.jsx)(l,{imageUrl:c.family.image_url,selectedColor:v}),(0,s.jsx)(r,{attributes:c.attributes,selectedSize:x,setSelectedSize:m,selectedSheen:g,setSelectedSheen:y}),(0,s.jsx)(d,{familyId:c.family.wc_product_id,variations:c.variations,selectedSize:x,selectedSheen:g,selectedColor:v})]}),(0,s.jsx)("div",{style:{flex:"2 1 400px"},children:(0,s.jsx)(a,{colors:u,selectedColor:v,onColorSelect:f})})]})]}):(0,s.jsx)("div",{className:"ps-builder-error",children:"Error: Failed to load Product Family data."}):(0,s.jsx)("div",{className:"ps-builder-error",children:"Error: No Product Family ID provided."})};document.addEventListener("DOMContentLoaded",()=>{const e=document.getElementById("paint-store-builder-root");if(e){const i=e.getAttribute("data-family-id");(0,t.render)((0,s.jsx)(n,{familyId:i}),e)}})})();